{% extends "base.html" %}
{% load static %}

{% block title %}Edit Seller Account{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <!-- Card -->
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">

          <div class="d-flex align-items-center gap-3 mb-3">
            <div style="width:72px;height:72px;border-radius:12px;overflow:hidden;background:#f1f3f5;border:1px solid #e9ecef;">
              {% if profile.avatar %}
                <img src="{{ profile.avatar.url }}" alt="Avatar" class="w-100 h-100" style="object-fit:cover;">
              {% else %}
                <img src="{% static 'profiles/default_profile.png' %}" alt="Avatar" class="w-100 h-100" style="object-fit:cover;">
              {% endif %}
            </div>
            <div>
              <h1 class="h4 mb-0">Edit Seller Account</h1>
              <div class="text-muted small">Signed in as <strong>{{ request.user.username }}</strong></div>
            </div>
          </div>

          {% if messages %}
            {% for m in messages %}
              <div class="alert alert-{{ m.tags }} mb-3">{{ m }}</div>
            {% endfor %}
          {% endif %}

          <form method="post" enctype="multipart/form-data" novalidate>
            {% csrf_token %}

            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">First name</label>
                {{ uform.first_name }}
                {% for e in uform.first_name.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>
              <div class="col-md-6">
                <label class="form-label">Last name</label>
                {{ uform.last_name }}
                {% for e in uform.last_name.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>
              <div class="col-12">
                <label class="form-label">Email</label>
                {{ uform.email }}
                {% for e in uform.email.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>

              <hr class="my-2">

              <div class="col-12">
                <label class="form-label">Avatar</label>
                {{ pform.avatar }}
                {% if profile.avatar %}
                  <div class="form-text">Current: <a href="{{ profile.avatar.url }}" target="_blank">view file</a></div>
                {% endif %}
                {% for e in pform.avatar.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>

              <div class="col-12">
                <label class="form-label">Phone (for buyers)</label>
                {{ pform.phone }}
                <div class="form-text">Example: +800 1976250250</div>
                {% for e in pform.phone.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>
            </div>

            <div class="d-flex gap-2 mt-4">
              <button class="btn btn-primary" type="submit">Save changes</button>
              <a class="btn btn-outline-secondary" href="{{ request.META.HTTP_REFERER|default:'/' }}">Cancel</a>
            </div>
          </form>

        </div>
      </div>

    </div>
  </div>
</div>
{% endblock %}